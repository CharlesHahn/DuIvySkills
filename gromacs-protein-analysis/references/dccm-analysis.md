# DCCM 分析

## 概述

动态互相关矩阵（DCCM, Dynamic Cross-Correlation Matrix）分析原子对之间的相关运动，识别协调运动和变构通讯途径。正相关（红色）表示原子一起移动，负相关（蓝色）表示相反移动。适用于识别变构途径、研究集体运动、分析结构域运动。

## 工作流程

### 输入文件
- `-s`：结构文件（.tpr）
- `-f`：轨迹文件（.xtc/.trr）

### 命令
```bash
# 步骤 1：计算协方差矩阵
gmx covar -s md.tpr -f md.xtc -o eigenvalues.xvg -v eigenvectors.trr -xpma covar.xpm

# 步骤 2：转换为 DCCM
dit dccm_ascii -f covar.xpm -o dccm.xpm
```

### 参数选择

**原子组选择**（两次交互输入）：
- **C-alpha**：Cα 原子，最常用（推荐）
- **Backbone**：主链原子
- **Protein**：所有蛋白质原子

**重要参数**：
- `-o`：特征值输出文件
- `-v`：特征向量输出文件（.trr 格式）
- `-xpma`：协方差矩阵输出文件（.xpm 格式）

### 输出
- **eigenvalues.xvg**：特征值（PC 编号-特征值）
- **eigenvectors.trr**：特征向量
- **covar.xpm**：协方差矩阵
- **dccm.xpm**：动态互相关矩阵（-1 到 +1）

### 可视化
```bash
dit xpm_show -f dccm.xpm -o dccm.png -zmin -1 -zmax 1 -cmap bwr -m contour
```

## 结果解释

### 相关强度

| 值范围 | 含义 |
|--------|------|
| > 0.5 | 强正相关 |
| 0.3-0.5 | 中等正相关 |
| 0.1-0.3 | 弱正相关 |
| -0.1-0.1 | 无显著相关 |
| -0.3-(-0.1) | 弱负相关 |
| -0.5-(-0.3) | 中等负相关 |
| < -0.5 | 强负相关 |

### 生物学解释
- **强正相关**：一起移动的刚性结构域，变构耦合
- **强负相关**：拮抗运动，铰链运动，呼吸模式
- **长程相关**：潜在的变构通讯途径
- **局部相关**：二级结构稳定性

### 矩阵特征
- **对角线**：始终为 +1（自相关）
- **对称性**：矩阵应对称
- **模式**：块或条纹指示相关结构域或途径

## 常见问题

**Q: DCCM 值都接近零？**  
A: 可能模拟时间不足、原子选择太少或噪声过多，延长模拟时间或使用更大原子组。

**Q: DCCM 显示不对称？**  
A: 确保轨迹已正确拟合和对齐。

**Q: DCCM 值超出 [-1, 1] 范围？**  
A: 检查计算步骤，正确计算的 DCCM 应在此范围内。