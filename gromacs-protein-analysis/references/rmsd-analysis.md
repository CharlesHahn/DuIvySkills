# RMSD 分析

## 概述

均方根偏差（RMSD, Root Mean Square Deviation）测量原子相对于参考结构的平均距离，是评估蛋白质结构稳定性和模拟收敛性的基础指标。适用于评估模拟平衡、比较不同条件、识别构象变化和验证模拟与实验结构。

## 工作流程

### 输入文件
- `-s`：结构文件（.tpr），提供参考坐标
- `-f`：轨迹文件（.xtc/.trr），包含待分析构象

### 命令

```bash
echo -e "Backbone\nProtein\n" | gmx rms -s md.tpr -f md.xtc -o rmsd.xvg
```
- **目的**：计算轨迹相对于参考结构的 RMSD 时间序列
- **参数说明**：
  - `-s md.tpr`：输入拓扑文件，包含参考结构（通常是模拟起始结构）
  - `-f md.xtc`：输入轨迹文件
  - `-o rmsd.xvg`：输出 RMSD 时间序列文件（XVG 格式）
- **管道输入**：`"Backbone\nProtein\n"` 第一个 Backbone 为最小二乘拟合组（用于对齐结构），第二个 Protein 为计算 RMSD 的目标组
- **拟合原理**：先以 Backbone 对齐轨迹帧到参考结构，再计算 Protein 原子的 RMSD

### 原子组选择策略

| 分析目标 | 拟合组 | 计算组 | 说明 |
|---------|-------|--------|------|
| 蛋白质整体稳定性 | Backbone | Protein | 最常用，消除旋转平移后计算全蛋白 RMSD |
| 配体结合稳定性 | Backbone | Ligand | 以蛋白主链对齐，计算配体 RMSD |
| 主链稳定性 | Backbone | Backbone | 仅关注主链运动 |
| 配体自身稳定性 | Ligand | Ligand | 评估配体构象变化 |

### 可选参数

```bash
gmx rms -s md.tpr -f md.xtc -o rmsd.xvg -tu ns -b 1000 -e 50000 -dt 100
```
- `-tu ns`：时间单位设为纳秒（默认 ps）
- `-b 1000`：起始时间 1000 ps，跳过平衡期
- `-e 50000`：结束时间 50000 ps
- `-dt 100`：采样间隔 100 ps，减少数据点

### 输出
- **rmsd.xvg**：时间序列数据
  - 第 1 列：时间（单位由 `-tu` 参数决定，默认 ps）
  - 第 2 列：RMSD 值（单位：nm）

### 可视化
```bash
dit xvg_show -f rmsd.xvg -x "Time (ns)" -y "RMSD (nm)" -t "RMSD"
```
- **目的**：绘制 RMSD 随时间变化曲线

## 结果解释

### RMSD 模式
- **初始上升后稳定**：正常平衡过程，蛋白质达到稳定构象
- **持续上升**：未收敛或蛋白质展开，需延长模拟
- **突变/跳跃**：PBC 问题或结构跳变，检查轨迹
- **低值波动（< 0.1 nm）**：蛋白质刚性或构象变化小

### 平衡判断
- 平衡起点：RMSD 首次达到稳定平台处
- 平稳期标准：RMSD 标准差 < 0.05 nm
- 收敛标志：长时间内无明显漂移趋势

## 常见问题

**Q: RMSD 显示突变跳跃？**  
A: 检查轨迹是否跨越 PBC 边界，考虑周期性校正。

**Q: RMSD 持续增加无平台期？**  
A: 可能模拟未收敛或蛋白质展开，延长模拟时间。