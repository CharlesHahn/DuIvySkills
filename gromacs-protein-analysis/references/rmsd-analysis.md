# RMSD 分析

## 概述

均方根偏差（RMSD, Root Mean Square Deviation）测量原子相对于参考结构的平均距离，是评估蛋白质结构稳定性和模拟收敛性的基础指标。适用于评估模拟平衡、比较不同条件、识别构象变化和验证模拟与实验结构。

## 工作流程

### 输入文件
- `-s`：结构文件（.tpr），提供参考坐标
- `-f`：轨迹文件（.xtc/.trr），包含待分析构象

### 命令
```bash
echo -e "Backbone\nProtein\n" | gmx rms -s md.tpr -f md.xtc -o rmsd.xvg
```

### 参数选择

**原子组选择**（两次交互输入）：
- **对齐组**：用于对齐的原子组，对于蛋白来说建议选择Backbone。
- **输出组**：计算 RMSD 的原子组，对于蛋白来说一般是整个分子的原子，比如说Protein。

如果计算蛋白相较于蛋白本身的RMSD，可以选择对齐组为Backbone，计算组为Protein。
如果计算配体相较于配体本身的RMSD，可以选择对齐组和计算组都为配体的全原子组索引。
如果计算蛋白配体复合物中配体相较于蛋白的结合稳定性，可以选择蛋白的Backbone作为对齐组，然后计算配体的RMSD。

**重要参数**：
- `-o`：输出文件（.xvg 格式，时间-RMSD）
- `-tu`：时间单位（ns, ps, us, ms, fs）
- `-b`：起始时间
- `-e`：结束时间
- `-dt`：采样间隔

### 输出
- **rmsd.xvg**：时间序列数据
  - 第 1 列：时间，默认单位是ps，除非命令里面使用了`-tu`参数指定时间单位
  - 第 2 列：RMSD 值（单位：nm）

### 可视化
```bash
dit xvg_show -f rmsd.xvg -x "Time (ns)" -y "RMSD (nm)" -t "RMSD"
```

## 结果解释

### RMSD 模式
- **初始上升后稳定**：正常平衡过程
- **持续上升**：未收敛或蛋白质展开
- **突变/跳跃/陡升陡降**：PBC周期性问题
- **低值波动**：蛋白质刚性或蛋白质构象较低

### 平衡判断
- 平衡起点：RMSD 首次达到稳定处
- 平稳期：RMSD 标准差 < 0.05 nm
- 收敛：长时间内无明显漂移

## 常见问题

**Q: RMSD 显示突变跳跃？**  
A: 检查轨迹是否跨越 PBC 边界，考虑 周期性校正。

**Q: RMSD 持续增加无平台期？**  
A: 可能模拟未收敛或蛋白质展开，延长模拟时间。
